<!-- 新页面：newpage.wxml -->
<van-search value="{{ name }}" placeholder="请输入搜索关键词" shape="round" bind:search="bindconfirm" use-right-icon-slot>
  <van-icon slot="right-icon" name="scan" bind:click="searchscan" />
</van-search>

<view class="main">
  <scroll-view class="goods-container" scroll-y="true" scroll-top="{{scrolltop}}" wx:if='{{onLoadStatus}}' bindscrolltolower="goodsGoBottom">
    <wxs module="goodsDetailPage">
    module.exports = {
      url : function(item) {
        if (item.supplyType == 'cps_jd') {
          return '/packageCps/pages/goods-details/cps-jd?id=' + item.id
        } else if (item.supplyType == 'vop_jd') {
          return '/pages/goods-details/vop?id=' + item.yyId + '&goodsId=' + item.id
        } else if (item.supplyType == 'cps_pdd') {
          return '/packageCps/pages/goods-details/cps-pdd?id=' + item.id
        } else if (item.supplyType == 'cps_taobao') {
          return '/packageCps/pages/goods-details/cps-taobao?id=' + item.id
        } else {
          return '/pages/goods-details/index?id=' + item.id
        }
      }
    }
    </wxs>
    <van-card
      wx:for="{{currentGoods}}" wx:key="id"
      price="{{item.minPrice}}"
      desc="{{item.numberSells ? '已售' + item.numberSells : ''}}"
      tag="{{item.gotScore ? (item.gotScore + (item.gotScoreType ? '%' : '') + '积分') : ''}}"
      title="{{item.name}}"
      title-class="title-class-apifm"
      thumb="{{item.pic}}"
      thumb-link="{{ goodsDetailPage.url(item) }}"
    >
      <view wx:if="{{ item.supplyType != 'vop_jd' }}" class="goods-btn" slot="footer">
        <van-icon wx:if="{{ item.propertyIds || item.hasAddition }}" name="add" color="#e64340" size="48rpx" data-id="{{item.id}}" bind:click="addShopCar" />
        <van-icon wx:else name="shopping-cart-o" color="#e64340" size="48rpx" data-id="{{item.id}}" bind:click="addShopCar" />
      </view>
    </van-card>
  </scroll-view>
</view>